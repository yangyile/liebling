{{!-- 如果是post页面，则取相近的3条posts --}}
{{#is "post"}}
  {{#get "posts" limit="3" filter="tags:[{{post.tags}}]+id:-{{post.id}}" include="tags,authors" as |related|}}
    <section class="m-recommended">
      <div class="l-wrapper in-recommended">
        <h3 class="m-section-title in-recommended">{{t "Latest posts"}}</h3>
        <div class="m-recommended-articles">
          <div class="m-recommended-slider js-recommended-articles">
            {{!-- The tag below iterates over all the related posts --}}
            {{> "loop"}}
          </div>
        </div>
      </div>
    </section>
    {{else}}
    <p class="yile-no-posts">{{t "No related posts are available."}}</p>
  {{/get}}
{{/is}}

{{!-- 如果是page，则取featured的3条posts --}}
{{#is "page"}}
  <div class="l-content">
    <div class="l-wrapper" data-aos="fade-up" data-aos-delay="300">
      <div class="l-grid centered">
        {{#get "posts" filter="featured:true" include="authors,tags" limit="5" as |featured|}}
          {{#if featured}}
            <div class="m-featured-slider">
              <div class="m-featured-slider__list js-featured-articles">
                {{#foreach featured}}
                  <div class="m-featured-slider__list__item">
                    <article class="m-featured-article {{#unless feature_image}}no-picture{{/unless}}">
                      <div class="m-featured-article__picture">
                        {{#if feature_image}}
                          <div class="lozad no-fade-animation" data-background-image="{{img_url feature_image size="l"}}"></div>
                        {{/if}}
                      </div>
                      <div class="m-featured-article__meta">
                        <a href="{{primary_author.url}}" class="m-featured-article__author js-tooltip" aria-label="Authors" data-tippy-content="{{t "Posted by"}} {{primary_author.name}} {{authors autolink="false" from="2" prefix=(t "Among with") separator=" , "}}">
                          {{#if primary_author.profile_image}}
                            <div style="background-image: url({{img_url primary_author.profile_image size="xs"}});"></div>
                          {{else}}
                            <div style="background-image: url({{asset "images/default-avatar-square-small.jpg"}});"></div>
                          {{/if}}
                        </a>
                        {{#if primary_tag}}
                          <a href="{{primary_tag.url}}" class="m-featured-article__tag">{{primary_tag.name}}</a>
                        {{/if}}
                      </div>
                      <div class="m-featured-article__ribbon">
                        <span class="icon-star"></span>
                        <span>{{t "Featured"}}</span>
                      </div>
                      <a href="{{url}}" class="m-featured-article__content">
                        <h2 class="m-featured-article__title js-featured-article-title" title="{{title}}">
                          {{title}}
                        </h2>
                        <div class="m-featured-article__timestamp">
                          <span>{{date published_at timeago="true"}}</span>
                          <span>&bull;</span>
                          <span>{{reading_time minute=(t "1 min read") minutes=(t "% min read")}}</span>
                        </div>
                      </a>
                    </article>
                  </div>
                {{/foreach}}
              </div>
            </div>
          {{/if}}
          {{else}}
          <p class="yile-no-posts">{{t "No featured posts are available"}}</p>
        {{/get}}
      </div>
    </div>
  </div>
{{/is}}
